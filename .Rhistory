civica_nse_leng_m = lmer(m_p.civ ~ 1 + m_nse + m_p.leng  + (1 | idschool), data = data, REML=F)
windowsFonts(A = windowsFont("Times New Roman"))
htmlreg(list(lenguaje_nse_c,civica_nse_c, civica_nse_leng_c, lenguaje_nse_m, civica_nse_m, civica_nse_leng_m), custom.coef.names = c("Intercepto", "NSE (C)", "Lenguaje (C)", "NSE (M)", "Lenguaje (M)" ), custom.model.names = c("Lenguaje (C)", "C. Civico (C)","C. Civico (C)", "Lenguaje (M)", "C. Civico (M)", "C. Civico (M)"), custom.header = list("Nivel 1" = 1:3, "Nivel 2" = 4:6), star.symbol = "\\*", center = T, custom.note = " <div style='text-align: justify'> $***p <$ 0.001, $**p <$ 0.01, $*p <$ 0.05 <br> (C) = Centrado a la media del colegio; (M) = Promedio del colegio;  Lenguaje = puntaje simce comprension lectora;  C.Civico = puntaje prueba de conocimiento civico", caption.above = T, caption = "Mediacion multinivel del lenguaje en la desigualdad social del conocimiento civico")
# proporcion del efecto controlado por lenguaje centrado (Nivel 1)
((18.84 - 11.29)*100)/18.4
# proporcion del efecto controlado por promedio del lenguaje (Nivel 2)
((55.86 - 43.31)*100)/55.86
sjlabelled::get_labels(data$Libros)
data <- data %>%
group_by(idschool) %>%
mutate(Libros_m = mean(Libros_cuan))
Libros_c = as.numeric(data$Libros_cuant - data$Libros_m)
libros_lenguaje_nse_c = lmer(p.leng_centrado ~ 1 +  Libros_c + Ocupacion + Educacion + (1 | idschool), data = data, REML=F)
data$Libros_c = as.numeric(data$Libros_cuant - data$Libros_m)
libros_lenguaje_nse_c = lmer(p.leng_centrado ~ 1 +  Libros_c + Ocupacion + Educacion + (1 | idschool), data = data, REML=F)
sjlabelled::get_labels(data$Libros)
data <- data %>%
group_by(idschool) %>%
mutate(Libros_m = mean(Libros_cuan))
data$Libros_c = as.numeric(data$Libros_cuant - data$Libros_m)
table(data$Libros_cuan)
data <- data %>%
group_by(idschool) %>%
mutate(Libros_m = mean(Libros_cuan))
hist(data$Libros_m)
data$Libros_c = as.numeric(data$Libros_cuan - data$Libros_m)
libros_lenguaje_nse_c = lmer(p.leng_centrado ~ 1 +  Libros_c + Ocupacion + Educacion + (1 | idschool), data = data, REML=F)
libros_civica_nse_c = lmer(p.civ_c ~ 1 +  Libros + Ocupacion + Educacion  + (1 | idschool), data = data, REML=F)
libros_civica_nse_leng_c = lmer(p.civ_c ~ 1 + Libros + Ocupacion + Educacion + p.leng_centrado  + (1 | idschool), data = data, REML=F)
libros_lenguaje_nse_m = lmer(m_p.leng ~ 1 +  Libros_m  + (1 | idschool), data = data, REML=F)
libros_civica_nse_leng_m = lmer(m_p.civ ~ 1 + Libros_m + m_p.leng  + (1 | idschool), data = data, REML=F)
screenreg(list(libros_lenguaje_nse_c,libros_civica_nse_c, libros_civica_nse_leng_c,libros_lenguaje_nse_m, libros_civica_nse_m, libros_civica_nse_leng_m), custom.model.names = c("Lenguaje (C)", "C. Civico (C)","C. Civico (C)", "Lenguaje (M)", "C. Civico (M)", "C. Civico (M)"), custom.header = list("Nivel 1" = 1:3, "Nivel 2" = 4:6), star.symbol = "\\*", center = T, custom.note = " <div style='text-align: justify'> $***p <$ 0.001, $**p <$ 0.01, $*p <$ 0.05 <br> (C) = Centrado a la media del colegio; (M) = Promedio del colegio;  Lenguaje = puntaje simce comprension lectora;  C.Civico = puntaje prueba de conocimiento civico", caption.above = T, caption = "Mediacion multinivel del lenguaje en la desigualdad social del conocimiento civico")
sjlabelled::get_labels(data$Libros)
data <- data %>%
group_by(idschool) %>%
mutate(Libros_m = mean(Libros_cuan))
data$Libros_c = as.numeric(data$Libros_cuan - data$Libros_m)
libros_lenguaje_nse_c = lmer(p.leng_centrado ~ 1 +  Libros_c + Ocupacion + Educacion + (1 | idschool), data = data, REML=F)
libros_civica_nse_c = lmer(p.civ_c ~ 1 +  Libros_c + Ocupacion + Educacion  + (1 | idschool), data = data, REML=F)
libros_civica_nse_leng_c = lmer(p.civ_c ~ 1 + Libros_c + Ocupacion + Educacion + p.leng_centrado  + (1 | idschool), data = data, REML=F)
libros_lenguaje_nse_m = lmer(m_p.leng ~ 1 +  Libros_m  + (1 | idschool), data = data, REML=F)
libros_civica_nse_leng_m = lmer(m_p.civ ~ 1 + Libros_m + m_p.leng  + (1 | idschool), data = data, REML=F)
screenreg(list(libros_lenguaje_nse_c,libros_civica_nse_c, libros_civica_nse_leng_c,libros_lenguaje_nse_m, libros_civica_nse_m, libros_civica_nse_leng_m), custom.model.names = c("Lenguaje (C)", "C. Civico (C)","C. Civico (C)", "Lenguaje (M)", "C. Civico (M)", "C. Civico (M)"), custom.header = list("Nivel 1" = 1:3, "Nivel 2" = 4:6), star.symbol = "\\*", center = T, custom.note = " <div style='text-align: justify'> $***p <$ 0.001, $**p <$ 0.01, $*p <$ 0.05 <br> (C) = Centrado a la media del colegio; (M) = Promedio del colegio;  Lenguaje = puntaje simce comprension lectora;  C.Civico = puntaje prueba de conocimiento civico", caption.above = T, caption = "Mediacion multinivel del lenguaje en la desigualdad social del conocimiento civico")
data <- iccssimce %>% select("p.leng"=ptje_lect8b_alu, "p.mat"=ptje_mate8b_alu, "p.nat"=ptje_nat8b_alu, "p.civ"=PV1CIV, "nse"=S_NISB, "ip_estudiante"=S_SINT, "ip_padres"=S_HINT,idschool,apert_disc=S_OPDISC, "cult_part"=S_VALPARTS, esp_part=C_ENGAGE , "Libros"=S_HOMLIT, "Ocupacion" = S_HISEI, "Educacion"=S_HISCED, IC3G13A, rel_prof=S_STUTREL, S_ABUSE) %>% as.data.frame()
data = na.omit(data)
sjlabelled::get_labels(data$Educacion)
data <- data %>%
group_by(idschool) %>%
mutate(oc_m = mean(Ocupacion))
data$oc_c= as.numeric(data$Ocupacion - data$oc_m)
libros_lenguaje_nse_c = lmer(p.leng_centrado ~ 1 +  Libros_c + oc_c + Educacion + (1 | idschool), data = data, REML=F)
data$p.leng_centrado <- (data$p.leng - data$m_p.leng)
data$p.leng_centrado <- as.numeric(data$p.leng - data$m_p.leng)
data <- data %>%
group_by(idschool) %>%
mutate(m_p.leng = mean(p.leng))
data$p.leng_centrado <- as.numeric(data$p.leng - data$m_p.leng)
libros_lenguaje_nse_c = lmer(p.leng_centrado ~ 1 +  Libros_c + oc_c + Educacion + (1 | idschool), data = data, REML=F)
pacman::p_load(lme4,
reghelper,
haven,
descr,
stargazer,
ggplot2, # gr?ficos
dplyr, # manipulacion de datos
texreg, # tablas lme4
sjPlot #graficos
)
iccssimce <- read_dta("../input/data/original/iccs_simce.dta")
data <- iccssimce %>% select("p.leng"=ptje_lect8b_alu, "p.mat"=ptje_mate8b_alu, "p.nat"=ptje_nat8b_alu, "p.civ"=PV1CIV, "nse"=S_NISB, "ip_estudiante"=S_SINT, "ip_padres"=S_HINT,idschool,apert_disc=S_OPDISC, "cult_part"=S_VALPARTS, esp_part=C_ENGAGE , "Libros"=S_HOMLIT, "Ocupacion" = S_HISEI, "Educacion"=S_HISCED, IC3G13A, rel_prof=S_STUTREL, S_ABUSE) %>% as.data.frame()
data = na.omit(data)
sjlabelled::get_labels(data$Educacion)
data$Libros_cuan<-ifelse(data$Libros>=0,5,data$Libros)
data$Libros_cuan<-ifelse(data$Libros>=1,18,data$Libros_cuan)
data$Libros_cuan<-ifelse(data$Libros>=2,63,data$Libros_cuan)
data$Libros_cuan<-ifelse(data$Libros>=3,150,data$Libros_cuan)
data$Libros_cuan<-ifelse(data$Libros>=4,250,data$Libros_cuan)
table(data$Libros_cuan)
data$Libros<-ifelse(data$Libros>=2,1,0)
data$IC3G13A<-ifelse(data$IC3G13A==2,1,0)
data$ip_padres<-ifelse(data$ip_padres>=2,1,0)
data$Educacion<-ifelse(data$Educacion>=3,1,0)
data$ip_estudiante.or<-data$ip_estudiante
data$ip_estudiante<-ifelse(data$ip_estudiante>=2,1,0)
data <- data %>%
group_by(idschool) %>%
mutate(m_nse = mean(nse))
data <- data %>%
group_by(idschool) %>%
mutate(m_apert_disc = mean(apert_disc))
data <- data %>%
group_by(idschool) %>%
mutate(clima_prof = mean(rel_prof))
data <- data %>%
group_by(idschool) %>%
mutate(m_esp_part = mean(esp_part))
data <- data %>%
group_by(idschool) %>%
mutate(m_ip_estudiante = mean(ip_estudiante))
data <- data %>%
group_by(idschool) %>%
mutate(sd_nse = sd(nse))
data <- data %>%
group_by(idschool) %>%
mutate(m_ip_padres = mean(ip_padres))
data <- data %>%
group_by(idschool) %>%
mutate(m_cult_part = mean(cult_part))
data <- data %>%
group_by(idschool) %>%
mutate(m_p.leng = mean(p.leng))
save(data, file="../input/data/proc/data.RData")
knitr::opts_chunk$set(echo = TRUE)
pacman::p_load(lme4,
reghelper,
haven,
descr,
stargazer,
ggplot2, # gr?ficos
dplyr, # manipulacion de datos
texreg, # tablas lme4
sjPlot #graficos
)
load(file = "../input/data/proc/data.RData")
library(ggplot2)
library(ggplot2)
library(hrbrthemes)
#install.packages("hrbrthemes")
data$alto_nse<-as.character(ifelse(data$nse>=0,1,0))
scatter <-ggplot(data, aes(x=p.civ, y=p.leng, color=alto_nse)) +
geom_point(size=2) +
theme_classic()
data$p.leng_centrado <- as.numeric(data$p.leng - data$m_p.leng)
summary(data)
#table(data$p.leng)
sd(data$p.civ)
results_1 = lmer(p.civ ~ 1 + (1 | idschool), data = data, REML=F)
screenreg(results_1)
data$p.leng_centrado <- (data$p.leng - data$m_p.leng)
results_1 = lmer(p.civ ~ 1 + Libros  + Ocupacion + Educacion + ip_padres + m_nse +  (1 | idschool), data = data, REML=F)
results_2 = lmer(p.civ ~ 1 + Libros +  Ocupacion + Educacion  +  ip_padres  + m_nse  +  m_cult_part  + (1 | idschool), data = data, REML=F)
results_3 = lmer(p.civ ~ 1 + Libros +  Ocupacion + Educacion  +  ip_padres + m_cult_part   + m_nse  + ip_estudiante +  (1 | idschool), data = data, REML=F)
results_4 = lmer(p.civ ~ 1 + Libros +  Ocupacion + Educacion +  +  ip_padres  + m_nse + ip_estudiante  +  m_cult_part   + p.leng + (1 + p.leng | idschool), data = data, REML=F)
results_5 = lmer(p.civ ~ 1 + Libros +  Ocupacion + Educacion + ip_padres + ip_estudiante  +  m_cult_part  + p.leng*m_nse + (1 + p.leng| idschool), data = data, REML=F)
save(results_1, file = "../output/images/results_1.Rdata")
save(results_2, file = "../output/images/results_2.Rdata")
save(results_3, file = "../output/images/results_3.Rdata")
save(results_4, file = "../output/images/results_4.Rdata")
save(results_5, file = "../output/images/results_5.Rdata")
regresion_tex <-texreg(list(results_1,results_2,results_3, results_4, results_5 ))
regresion_html <-htmlreg(list(results_1,results_2,results_3, results_4, results_5 ))
save(regresion_tex, file = "../output/images/regtex.Rdata")
save(regresion_tex, file = "../output/images/reghtml.Rdata")
load(file = "../output/images/reghtml.Rdata")
inta<-plot_model(results_5, type = "int")
inta
results_7 = lmer(p.civ ~ 1 + Libros +  Ocupacion + Educacion + ip_padres + ip_estudiante  + m_ip_padres + m_nse + m_nse*p.leng + (1 + p.leng| idschool), data = data, REML=F)
results_8 = lmer(p.civ ~ 1 + Libros +  Ocupacion + Educacion + ip_padres + ip_estudiante  + m_ip_padres + m_nse + m_nse*p.leng_centrado + (1 + p.leng_centrado| idschool), data = data, REML=F)
screenreg(list(results_7,results_8), type="text")
save(results_7, file = "../output/images/results_7.Rdata")
save(results_8, file = "../output/images/results_8.Rdata")
int2<-plot_model(results_7, type = "int")
int2
results_7 = lmer(p.civ ~ 1 + Libros +  Ocupacion + Educacion + ip_padres + ip_estudiante  + m_ip_padres + m_nse + Ocupacion*p.leng_centrado + (1 + p.leng_centrado| idschool), data = data, REML=F)
int1<-plot_model(results_5, type = "int")
sjPlot::plot_model(results_5, type = c("int"),                                                                title = "¿Como disminuir la desigualdad en el conocimiento cívico?",
mdrt.values = "meansd") +  scale_color_discrete("Puntaje de conocimiento cívico", labels = c("- 1 DS", "Media", "+ 1 DS")) + theme(legend.position = "bottom")
#int2<-plot_model(results_6, type = "int")
intcentrada<-plot_model(results_7, type = "int")
save(int1, file= "../output/images/int1.png")
save(int2, file= "../output/images/int2.png")
save(intcentrada, file= "../output/images/int3.png")
int1
int2
intcentrada
results_2 = lmer(p.civ ~ 1 + Libros +  Ocupacion + ip_estudiante +  ip_padres + Educacion + p.leng  + m_nse + m_ip_padres +  (1 | idschool), data = data, REML=F)
screenreg(results_2)
results_3 = lmer(p.civ ~ 1 + Libros +  Ocupacion + ip_estudiante + ip_padres + Educacion + p.leng + m_nse + (1 + p.leng| idschool), data = data, REML=F)
screenreg(results_3)
results_3_lm = lm(p.civ ~ Libros +  Ocupacion + ip_estudiante +  ip_padres + Educacion + p.leng,  data = data)
anova(results_2,results_3)
results_6 = lmer(p.civ ~ 1 + Libros +  Ocupacion + ip_padres + ip_estudiante + Educacion + p.leng*m_nse +  (1 + p.leng| idschool), data = data, REML=F)
results_6
anova(results_2,results_3)
anova(results_3,results_4)
anova(results_2,results_4)
results_12 = lmer(p.civ ~ 1 + Libros +  Ocupacion + ip_estudiante +  ip_padres + Educacion + m_nse +  (1 | idschool), data = data, REML=F)
screenreg(list(results_1,results_12, results_2,results_3, results_6), type="text")
#plot_model(results_5, type = "int")
plot_model(results_6, type = "int")
library(corrplot)
basecor<-select(data, m_ip_padres, m_cult_part, m_apert_disc, m_esp_part,m_nse, m_p.leng, p.civ, p.leng, nse)
cor <- cor(basecor)
Correlaciones  <-corrplot.mixed(cor)
save(Correlaciones, file = "../output/images/correlaciones.html")
library(corrplot)
basecor<-select(data, m_ip_padres, m_cult_part, m_apert_disc, m_esp_part,m_nse, m_p.leng, p.civ, p.leng, nse)
cor <- cor(basecor)
Correlaciones  <-corrplot.mixed(cor)
save(Correlaciones, file = "../output/images/correlaciones.html")
data$p.leng_centrado <- (data$p.leng - data$m_p.leng)
results_sincentrado = lmer(p.civ ~ 1 + ip_padres + p.leng + nse + m_ip_padres + m_ip_estudiante + cult_part + (1 + p.leng| idschool), data = data, REML=F)
results_concentrado = lmer(p.civ ~ 1 + ip_padres + p.leng_centrado + nse + m_ip_padres + m_ip_estudiante + cult_part + (1 + p.leng_centrado| idschool), data = data, REML=F)
results_concentrado_interaccion = lmer(p.civ ~ 1 + ip_padres + p.leng_centrado*nse + m_ip_padres + m_ip_estudiante  + (1 + p.leng_centrado| idschool), data = data, REML=F)
screenreg(list(results_sincentrado, results_concentrado,results_concentrado_interaccion ), type="text")
results_5 = lmer(p.civ ~ 1 + ip_padres + nse*p.leng_centrado  + m_p.leng + m_ip_padres + m_ip_estudiante + (1 + nse| idschool), data = data, REML=F)
regresion<-stargazer(results_5, type="text")
plot_model(results_5, type = "int")
hist(data$Ocupacion)
save(results_5, file = "../output/images/results_5.Rdata")
lenguaje_nse = lmer(p.leng ~ 1 +  nse  + (1 | idschool), data = data, REML=F)
civica_nse = lmer(p.civ ~ 1 +  nse  + (1 | idschool), data = data, REML=F)
civica_nse_leng = lmer(p.civ ~ 1 + nse + p.leng  + (1 | idschool), data = data, REML=F)
civica_nse_int = lmer(p.civ ~ 1 + nse + ip_estudiante  + (1 | idschool), data = data, REML=F)
civica_nse_intleng = lmer(p.civ ~ 1 + nse + ip_estudiante + p.leng + (1 | idschool), data = data, REML=F)
screenreg(list(lenguaje_nse, civica_nse,civica_nse_leng,civica_nse_int,civica_nse_intleng), type="text")
data$nse_c = as.numeric(data$nse - data$m_nse)
data <- data %>%
group_by(idschool) %>%
mutate(m_ip_estudiante.or = mean(ip_estudiante.or))
data$ipe_c = as.numeric(data$ip_estudiante.or - data$m_ip_estudiante.or)
data <- data %>%
group_by(idschool) %>%
mutate(m_p.civ = mean(p.civ))
data$p.civ_c = as.numeric(data$p.civ - data$m_p.civ)
lenguaje_nse_c = lmer(p.leng_centrado ~ 1 +  nse_c  + (1 | idschool), data = data, REML=F)
int_nse_c = lmer(ipe_c ~ 1  + nse_c  + (1 | idschool), data = data, REML=F)
civica_nse_c = lmer(p.civ_c ~ 1 +  nse_c  + (1 | idschool), data = data, REML=F)
civica_nse_int_c = lmer(p.civ_c ~ 1 + nse_c + ipe_c  + (1 | idschool), data = data, REML=F)
civica_nse_leng_c = lmer(p.civ_c ~ 1 + nse_c + p.leng_centrado  + (1 | idschool), data = data, REML=F)
civica_nse_intleng_c = lmer(p.civ_c ~ 1 + nse_c + ipe_c + p.leng_centrado + (1 | idschool), data = data, REML=F)
screenreg(list(lenguaje_nse_c, int_nse_c,civica_nse_c,civica_nse_int_c,civica_nse_leng_c,civica_nse_intleng_c), type="text")
# Proporcion del efectpo controlada por lenguaje (36%)
24.6 - 15.7
(8.9*100)/24.6
# Proporcion del efecto controlada por interes politico (5%)
24.46 - 23.33
(1.3*100)/24.46
# Hacer porcentaje lenguaje centrado
summary(data$p.leng_centrado)
168.3130 + 123.8707
292.1837 - 100
data$p.leng.c.pr <- as.numeric((data$p.leng_centrado + 168.3130)*100)/292.1837
hist(data$p.leng.c.pr)
#Hacer porcentaje interes poltico centrado
summary(data$ipe_c)
0.6522 + 2.9600
data$ipe_c.pr <- as.numeric((data$ipe_c + 0.6522 )*100)/3.6122
hist(data$ipe_c.pr)
# Hacer porcentaje conocimiento civico
summary(data$p.civ_c)
287.54 + 241.57
529.11
data$p.civ_c.pr <- as.numeric((data$p.civ_c + 287.54 )*100)/529.11
hist(data$p.civ_c.pr)
# hacer porcentaje nivel socioeconomico centrado
summary(data$nse_c)
2.33171  + 2.79194
5.12365
data$nse_c.pr <- as.numeric((data$nse_c + 2.33171 )*100)/5.12365
hist(data$nse_c.pr)
lenguaje_nse_c = lmer(p.leng.c.pr ~ 1 +  nse_c.pr  + (1 | idschool), data = data, REML=F)
int_nse_c = lmer(ipe_c.pr ~ 1  + nse_c.pr  + (1 | idschool), data = data, REML=F)
civica_nse_c = lmer(p.civ_c.pr ~ 1 +  nse_c.pr  + (1 | idschool), data = data, REML=F)
civica_nse_int_c = lmer(p.civ_c.pr ~ 1 + nse_c.pr + ipe_c.pr  + (1 | idschool), data = data, REML=F)
civica_nse_leng_c = lmer(p.civ_c.pr ~ 1 + nse_c.pr + p.leng.c.pr  + (1 | idschool), data = data, REML=F)
civica_nse_intleng_c = lmer(p.civ_c.pr ~ 1 + nse_c.pr + ipe_c.pr + p.leng.c.pr + (1 | idschool), data = data, REML=F)
screenreg(list(lenguaje_nse_c, int_nse_c,civica_nse_c,civica_nse_int_c,civica_nse_leng_c,civica_nse_intleng_c), type="text")
lenguaje_nse_m = lmer(m_p.leng ~ 1 +  m_nse  + (1 | idschool), data = data, REML=F)
civica_nse_m = lmer(m_p.civ ~ 1 +  m_nse  + (1 | idschool), data = data, REML=F)
civica_nse_leng_m = lmer(m_p.civ ~ 1 + m_nse + m_p.leng  + (1 | idschool), data = data, REML=F)
civica_int_m = lmer(m_p.civ ~ 1  + m_ip_estudiante  + (1 | idschool), data = data, REML=F)
civica_nse_int_m = lmer(m_p.civ ~ 1 + m_nse + m_ip_estudiante  + (1 | idschool), data = data, REML=F)
civica_nse_intleng_m = lmer(m_p.civ ~ 1 + m_nse + m_ip_estudiante + m_p.leng + (1 | idschool), data = data, REML=F)
screenreg(list(lenguaje_nse_m, civica_nse_m,civica_nse_leng_m,civica_nse_int_m,civica_nse_intleng_m), type="text")
summary(data$m_p.leng)
data$m_p.leng.pr = as.numeric(((data$m_p.leng)*100)/335.9)
hist(data$m_p.leng.pr)
summary(data$m_p.civ)
data$m_p.civ.pr = as.numeric(((data$m_p.civ)*100)/604.6)
hist(data$m_p.civ.pr)
summary(data$m_ip_estudiante.or)
data$m_ip_estudiante.pr = as.numeric(((data$m_ip_estudiante.or)*100)/2)
hist(data$m_ip_estudiante.pr)
summary(data$m_nse)
data$m_nse.pr = as.numeric(((data$m_nse)*100)/2.2300)
hist(data$m_nse.pr)
lenguaje_nse_m = lmer(m_p.leng.pr ~ 1 +  m_nse.pr  + (1 | idschool), data = data, REML=F)
int_nse = lmer(m_ip_estudiante.pr ~ 1 +  m_nse.pr  + (1 | idschool), data = data, REML=F)
civica_nse_m = lmer(m_p.civ.pr ~ 1 +  m_nse.pr  + (1 | idschool), data = data, REML=F)
civica_nse_leng_m = lmer(m_p.civ.pr ~ 1 + m_nse.pr + m_p.leng.pr  + (1 | idschool), data = data, REML=F)
civica_nse_int_m = lmer(m_p.civ.pr ~ 1 + m_nse.pr + m_ip_estudiante.pr  + (1 | idschool), data = data, REML=F)
civica_nse_intleng_m = lmer(m_p.civ.pr ~ 1 + m_nse.pr + m_ip_estudiante.pr + m_p.leng.pr + (1 | idschool), data = data, REML=F)
screenreg(list(lenguaje_nse_m,int_nse,civica_nse_m, civica_nse_leng_m,civica_nse_int_m,civica_nse_intleng_m), type="text")
lenguaje_nse_c = lmer(p.leng_centrado ~ 1 +  nse_c  + (1 | idschool), data = data, REML=F)
civica_nse_c = lmer(p.civ_c ~ 1 +  nse_c  + (1 | idschool), data = data, REML=F)
civica_nse_leng_c = lmer(p.civ_c ~ 1 + nse_c + p.leng_centrado  + (1 | idschool), data = data, REML=F)
lenguaje_nse_m = lmer(m_p.leng ~ 1 +  m_nse  + (1 | idschool), data = data, REML=F)
civica_nse_m = lmer(m_p.civ ~ 1 +  m_nse  + (1 | idschool), data = data, REML=F)
civica_nse_leng_m = lmer(m_p.civ ~ 1 + m_nse + m_p.leng  + (1 | idschool), data = data, REML=F)
windowsFonts(A = windowsFont("Times New Roman"))
htmlreg(list(lenguaje_nse_c,civica_nse_c, civica_nse_leng_c, lenguaje_nse_m, civica_nse_m, civica_nse_leng_m), custom.coef.names = c("Intercepto", "NSE (C)", "Lenguaje (C)", "NSE (M)", "Lenguaje (M)" ), custom.model.names = c("Lenguaje (C)", "C. Civico (C)","C. Civico (C)", "Lenguaje (M)", "C. Civico (M)", "C. Civico (M)"), custom.header = list("Nivel 1" = 1:3, "Nivel 2" = 4:6), star.symbol = "\\*", center = T, custom.note = " <div style='text-align: justify'> $***p <$ 0.001, $**p <$ 0.01, $*p <$ 0.05 <br> (C) = Centrado a la media del colegio; (M) = Promedio del colegio;  Lenguaje = puntaje simce comprension lectora;  C.Civico = puntaje prueba de conocimiento civico", caption.above = T, caption = "Mediacion multinivel del lenguaje en la desigualdad social del conocimiento civico")
# proporcion del efecto controlado por lenguaje centrado (Nivel 1)
((18.84 - 11.29)*100)/18.4
# proporcion del efecto controlado por promedio del lenguaje (Nivel 2)
((55.86 - 43.31)*100)/55.86
sjlabelled::get_labels(data$Libros)
data <- data %>%
group_by(idschool) %>%
mutate(Libros_m = mean(Libros_cuan))
data <- data %>%
group_by(idschool) %>%
mutate(oc_m = mean(Ocupacion))
data$oc_c= as.numeric(data$Ocupacion - data$oc_m)
data$Libros_c = as.numeric(data$Libros_cuan - data$Libros_m)
libros_lenguaje_nse_c = lmer(p.leng_centrado ~ 1 +  Libros_c + oc_c + Educacion + (1 | idschool), data = data, REML=F)
libros_civica_nse_c = lmer(p.civ_c ~ 1 +  Libros_c + oc_c + Educacion  + (1 | idschool), data = data, REML=F)
libros_civica_nse_leng_c = lmer(p.civ_c ~ 1 + Libros_c + oc_c + Educacion + p.leng_centrado  + (1 | idschool), data = data, REML=F)
libros_lenguaje_nse_m = lmer(m_p.leng ~ 1 +  Libros_m  + (1 | idschool), data = data, REML=F)
libros_civica_nse_m = lmer(m_p.civ ~ 1 +  Libros_m  + (1 | idschool), data = data, REML=F)
libros_civica_nse_leng_m = lmer(m_p.civ ~ 1 + Libros_m + m_p.leng  + (1 | idschool), data = data, REML=F)
screenreg(list(libros_lenguaje_nse_c,libros_civica_nse_c, libros_civica_nse_leng_c,libros_lenguaje_nse_m, libros_civica_nse_m, libros_civica_nse_leng_m), custom.model.names = c("Lenguaje (C)", "C. Civico (C)","C. Civico (C)", "Lenguaje (M)", "C. Civico (M)", "C. Civico (M)"), custom.header = list("Nivel 1" = 1:3, "Nivel 2" = 4:6), star.symbol = "\\*", center = T, custom.note = " <div style='text-align: justify'> $***p <$ 0.001, $**p <$ 0.01, $*p <$ 0.05 <br> (C) = Centrado a la media del colegio; (M) = Promedio del colegio;  Lenguaje = puntaje simce comprension lectora;  C.Civico = puntaje prueba de conocimiento civico", caption.above = T, caption = "Mediacion multinivel del lenguaje en la desigualdad social del conocimiento civico")
screenreg(list(libros_lenguaje_nse_c, libros_civica_nse_c,libros_civica_nse_leng_c))
results_1 = lmer(p.civ ~ 1 + Libros  + Ocupacion + Educacion + ip_padres + m_nse +  (1 | idschool), data = data, REML=F)
results_2 = lmer(p.civ ~ 1 + Libros +  Ocupacion + Educacion  +  ip_padres  + m_nse  +  m_cult_part  + (1 | idschool), data = data, REML=F)
results_3 = lmer(p.civ ~ 1 + Libros +  Ocupacion + Educacion  +  ip_padres + m_cult_part   + m_nse  + ip_estudiante +  (1 | idschool), data = data, REML=F)
results_4 = lmer(p.civ ~ 1 + Libros +  Ocupacion + Educacion +  +  ip_padres  + m_nse + ip_estudiante  +  m_cult_part   + p.leng + (1 + p.leng | idschool), data = data, REML=F)
results_5 = lmer(p.civ ~ 1 + Libros +  Ocupacion + Educacion + ip_padres + ip_estudiante  +  m_cult_part  + m_nse*p.leng + (1 + p.leng| idschool), data = data, REML=F)
results_6 = lmer(p.civ ~ 1 + ip_padres + ip_estudiante  +  m_cult_part  + nse*p.leng + (1 + p.leng| idschool), data = data, REML=F)
htmlreg(list(results_1, results_2,results_3, results_4, results_5),
custom.coef.names = c("Intercepto", "Más de 100 libros en el hogar", "Estatus ocupacional de los padres", "Padres con educación universitaria o más",
"Interes político de los padres", "Media NSE de la escuela (M.NSE)","Cultura participativa de la escuela", "Interes político del estudiante", "Comprensión lectora (C.Lec)", "Interacción: C.Lec*M.NSE"),
caption.above = T,
star.symbol = "\\*",
center = T,
caption = "Análisis Multinivel",
custom.header = list("Modelos para explicar nivel de Conocimiento Civico" = 1:5),
custom.note = "$***p <$ 0.001, $**p <$ 0.01, $*p <$ 0.05; Las variables Libros, Educación e Interes político son dicotómicas",
custom.model.names = c("Modelo 1", "Modelo 2", "Modelo 3", "Modelo 4", "Modelo 5"))
inter2<-sjPlot::plot_model(results_5, type = c("int"),  mdrt.values = c("meansd") ,                                                             title = "¿Como disminuir la desigualdad en el conocimiento cívico?", axis.title = c("Nivel socioeconómico promedio de la escuela","Conocimiento cívico") ) +  scale_color_discrete("Comprension lectora", labels= c("Insuficiente (-1sd)", "Elemental (promedio)", "Adecuado (+1sd)"))
ggsave(inter2, filename = "inter2.png",device = "png",width = 20,height = 10,dpi = "retina",units = "cm")
pl <- ggplot(data, aes(x=p.civ))
dist<- pl + geom_histogram(binwidth=10, aes(fill=..count..), col='black', fill="orange") + theme("clasic") + set_theme(legend.pos  ="bottom", base = theme_classic()) + xlab("Conocimiento Civico") + ylab("Frecuencia ")
ggsave(dist, filename = "dist.png",device = "png",width = 20,height = 10,dpi = "retina",units = "cm")
pl <- ggplot(data, aes(x=p.leng))
dist2<- pl + geom_histogram(binwidth=10, aes(fill=..count..), col='black', fill="orange") + theme("clasic") + set_theme(legend.pos  ="bottom", base = theme_classic()) + xlab("Conocimiento Civico") + ylab("Frecuencia ")
ggsave(dist2, filename = "dist2.png",device = "png",width = 20,height = 10,dpi = "retina",units = "cm")
summary(data$p.civ)
data[,"tramosciv"] <- cut(data$p.civ, breaks = c(232.1,395,478,563, 782.7), labels = c("Insuficiente", "Conoce", "Comprende", "Evalua"))
freq(data$tramosciv)
summary(data$p.leng)
data$tramosleg <- cut(data$p.leng, breaks = c(126,244,292,373.2), labels = c("Lectura insuficiente", "Lectura elemental", "Lectura adecuada"))
freq(data$tramosleg)
matrix<-table(data$tramosleg,data$tramosciv)
chisq.test(matrix)
scatter.smooth(data$p.civ,data$p.leng)
mosaicplot(matrix, color =F, xlab = "Nivel de conocimiento Civico", ylab = "Nivel de comprensión lectora", shade =T, border = "orange" )
library(ggplot2)
scater<-ggplot(data, aes(x=p.leng, y=p.civ)) +
geom_point(color="orange") + xlab("Comprensión Lectora") + ylab("Conocimiento Cívico") + geom_smooth(method=lm, se=T)
ggsave(scater, filename = "scater.png",device = "png",width = 20,height = 10,dpi = "retina",units = "cm")
cor(data$p.civ,data$p.leng)
bartpot<-barplot(matrix,  legend = rownames(matrix), beside=T,axis.lty = 2, col=c("orange","yellow","white"), xlab=("Nivel de conocimiento cívico"), ylab="Frecuencia", main = "Nivel de compresión lectora según habilidad alcanzada en c.civico")
save(bartpot,file="bartpot.png")
data <- data %>%
group_by(idschool) %>%
mutate(ed_m = mean(Educacion))
data$ed_c= as.numeric(data$Educacion - data$ed_C)
data$ed_c= as.numeric(data$Educacion - data$ed_m)
libros_lenguaje_nse_c = lmer(p.leng_centrado ~ 1 +  Libros_c + oc_c + ed_c + (1 | idschool), data = data, REML=F)
libros_civica_nse_c = lmer(p.civ_c ~ 1 +  Libros_c + oc_c + ed_c  + (1 | idschool), data = data, REML=F)
libros_civica_nse_leng_c = lmer(p.civ_c ~ 1 + Libros_c + oc_c + ed_c + p.leng_centrado  + (1 | idschool), data = data, REML=F)
libros_lenguaje_nse_m = lmer(m_p.leng ~ 1 +  Libros_m  + (1 | idschool), data = data, REML=F)
libros_lenguaje_nse_m = lmer(m_p.leng ~ 1 +  Libros_m  + (1 | idschool), data = data, REML=F)
libros_civica_nse_m = lmer(m_p.civ ~ 1 +  Libros_m  + (1 | idschool), data = data, REML=F)
libros_lenguaje_nse_m = lmer(m_p.leng ~ 1 +  Libros_m  + (1 | idschool), data = data, REML=F)
libros_civica_nse_m = lmer(m_p.civ ~ 1 +  Libros_m  + (1 | idschool), data = data, REML=F)
libros_civica_nse_leng_m = lmer(m_p.civ ~ 1 + Libros_m + m_p.leng  + (1 | idschool), data = data, REML=F)
screenreg(list(libros_lenguaje_nse_c,libros_civica_nse_c, libros_civica_nse_leng_c,libros_lenguaje_nse_m, libros_civica_nse_m, libros_civica_nse_leng_m), custom.model.names = c("Lenguaje (C)", "C. Civico (C)","C. Civico (C)", "Lenguaje (M)", "C. Civico (M)", "C. Civico (M)"), custom.header = list("Nivel 1" = 1:3, "Nivel 2" = 4:6), star.symbol = "\\*", center = T, custom.note = " <div style='text-align: justify'> $***p <$ 0.001, $**p <$ 0.01, $*p <$ 0.05 <br> (C) = Centrado a la media del colegio; (M) = Promedio del colegio;  Lenguaje = puntaje simce comprension lectora;  C.Civico = puntaje prueba de conocimiento civico", caption.above = T, caption = "Mediacion multinivel del lenguaje en la desigualdad social del conocimiento civico")
libros_lenguaje_nse_m = lmer(m_p.leng ~ 1 +  Libros_m + oc_m + ed_m  + (1 | idschool), data = data, REML=F)
libros_civica_nse_m = lmer(m_p.civ ~ 1 +  Libros_m + oc_m + ed_m  + (1 | idschool), data = data, REML=F)
libros_civica_nse_leng_m = lmer(m_p.civ ~ 1 + Libros_m + oc_m + ed_m + m_p.leng  + (1 | idschool), data = data, REML=F)
screenreg(list(libros_lenguaje_nse_c,libros_civica_nse_c, libros_civica_nse_leng_c,libros_lenguaje_nse_m, libros_civica_nse_m, libros_civica_nse_leng_m), custom.model.names = c("Lenguaje (C)", "C. Civico (C)","C. Civico (C)", "Lenguaje (M)", "C. Civico (M)", "C. Civico (M)"), custom.header = list("Nivel 1" = 1:3, "Nivel 2" = 4:6), star.symbol = "\\*", center = T, custom.note = " <div style='text-align: justify'> $***p <$ 0.001, $**p <$ 0.01, $*p <$ 0.05 <br> (C) = Centrado a la media del colegio; (M) = Promedio del colegio;  Lenguaje = puntaje simce comprension lectora;  C.Civico = puntaje prueba de conocimiento civico", caption.above = T, caption = "Mediacion multinivel del lenguaje en la desigualdad social del conocimiento civico")
libros_lenguaje_nse_mc = lmer(p.leng_centrado ~ 1 +  Libros_c + oc_c +  Libros_m + oc_m + ed_m + ed_c + (1 | idschool), data = data, REML=F)
libros_civica_nse_mc = lmer(p.civ_c ~ 1 +  Libros_c + oc_c + ed_c  +  Libros_m + oc_m + ed_m + (1 | idschool), data = data, REML=F)
libros_civica_nse_leng_mc = lmer(p.civ_c ~ 1 + Libros_c + oc_c + ed_c+  Libros_m + oc_m + ed_m  + p.leng_centrado  + (1 | idschool), data = data, REML=F)
screenreg(list(libros_lenguaje_nse_mc, libros_civica_nse_mc,libros_civica_nse_leng_mc))
libros_lenguaje_nse_mc = lmer(p.leng_centrado ~ 1 +  Libros_c + oc_c + ed_c +  Libros_m + oc_m + ed_m  + (1 | idschool), data = data, REML=F)
libros_civica_nse_mc = lmer(p.civ_c ~ 1 +  Libros_c + oc_c + ed_c  +  Libros_m + oc_m + ed_m + (1 | idschool), data = data, REML=F)
libros_civica_nse_leng_mc = lmer(p.civ_c ~ 1 + Libros_c + oc_c + ed_c+  Libros_m + oc_m + ed_m  + p.leng_centrado  + (1 | idschool), data = data, REML=F)
screenreg(list(libros_lenguaje_nse_mc, libros_civica_nse_mc,libros_civica_nse_leng_mc))
screenreg(list(libros_lenguaje_nse_c,libros_civica_nse_c, libros_civica_nse_leng_c,libros_lenguaje_nse_m, libros_civica_nse_m, libros_civica_nse_leng_m), custom.model.names = c("Lenguaje (C)", "C. Civico (C)","C. Civico (C)", "Lenguaje (M)", "C. Civico (M)", "C. Civico (M)"),custom.coef.names = c("Intercepto", "Libros (C)", "Ocupación (C)", "Educación (C)", "Libros (M)", "Ocupación (M)", "Educación (M)", "Lenguaje (M)") , custom.header = list("Nivel 1" = 1:3, "Nivel 2" = 4:6), star.symbol = "\\*", center = T, custom.note = " <div style='text-align: justify'> $***p <$ 0.001, $**p <$ 0.01, $*p <$ 0.05 <br> (C) = Centrado a la media del colegio; (M) = Promedio del colegio;  Lenguaje = puntaje simce comprension lectora;  C.Civico = puntaje prueba de conocimiento civico", caption.above = T, caption = "Mediacion multinivel del lenguaje en la desigualdad social del conocimiento civico")
screenreg(list(libros_lenguaje_nse_c,libros_civica_nse_c, libros_civica_nse_leng_c,libros_lenguaje_nse_m, libros_civica_nse_m, libros_civica_nse_leng_m), custom.model.names = c("Lenguaje (C)", "C. Civico (C)","C. Civico (C)", "Lenguaje (M)", "C. Civico (M)", "C. Civico (M)") , custom.header = list("Nivel 1" = 1:3, "Nivel 2" = 4:6), star.symbol = "\\*", center = T, custom.note = " <div style='text-align: justify'> $***p <$ 0.001, $**p <$ 0.01, $*p <$ 0.05 <br> (C) = Centrado a la media del colegio; (M) = Promedio del colegio;  Lenguaje = puntaje simce comprension lectora;  C.Civico = puntaje prueba de conocimiento civico", caption.above = T, caption = "Mediacion multinivel del lenguaje en la desigualdad social del conocimiento civico")
screenreg(list(libros_lenguaje_nse_c,libros_civica_nse_c, libros_civica_nse_leng_c,libros_lenguaje_nse_m, libros_civica_nse_m, libros_civica_nse_leng_m), custom.model.names = c("Lenguaje (C)", "C. Civico (C)","C. Civico (C)", "Lenguaje (M)", "C. Civico (M)", "C. Civico (M)"), custom.coef.names = c("Intercepto", "Libros (C)", "Ocupación (C)", "Educación (C)", "Lenguaje (C)", "Libros (M)", "Ocupación (M)", "Educación (M)", "Lenguaje (M)") , custom.header = list("Nivel 1" = 1:3, "Nivel 2" = 4:6), star.symbol = "\\*", center = T, custom.note = " <div style='text-align: justify'> $***p <$ 0.001, $**p <$ 0.01, $*p <$ 0.05 <br> (C) = Centrado a la media del colegio; (M) = Promedio del colegio;  Lenguaje = puntaje simce comprension lectora;  C.Civico = puntaje prueba de conocimiento civico", caption.above = T, caption = "Mediacion multinivel del lenguaje en la desigualdad social del conocimiento civico")
screenreg(list(libros_lenguaje_nse_mc, libros_civica_nse_mc,libros_civica_nse_leng_mc))
screenreg(list(libros_lenguaje_nse_c,libros_civica_nse_c, libros_civica_nse_leng_c,libros_lenguaje_nse_m, libros_civica_nse_m, libros_civica_nse_leng_m), custom.model.names = c("Lenguaje (C)", "C. Civico (C)","C. Civico (C)", "Lenguaje (M)", "C. Civico (M)", "C. Civico (M)"), custom.coef.names = c("Intercepto", "Libros (C)", "Ocupación (C)", "Educación (C)", "Lenguaje (C)", "Libros (M)", "Ocupación (M)", "Educación (M)", "Lenguaje (M)") , custom.header = list("Nivel 1" = 1:3, "Nivel 2" = 4:6), star.symbol = "\\*", center = T, custom.note = " <div style='text-align: justify'> $***p <$ 0.001, $**p <$ 0.01, $*p <$ 0.05 <br> (C) = Centrado a la media del colegio; (M) = Promedio del colegio;  Lenguaje = puntaje simce comprension lectora;  C.Civico = puntaje prueba de conocimiento civico", caption.above = T, caption = "Mediacion multinivel del lenguaje en la desigualdad social del conocimiento civico")
screenreg(list(libros_lenguaje_nse_c,libros_civica_nse_c, libros_civica_nse_leng_c,libros_lenguaje_nse_m, libros_civica_nse_m, libros_civica_nse_leng_m,libros_lenguaje_nse_mc, libros_civica_nse_mc,libros_civica_nse_leng_mc), custom.model.names = c("Lenguaje (C)", "C. Civico (C)","C. Civico (C)", "Lenguaje (M)", "C. Civico (M)", "C. Civico (M)"), custom.coef.names = c("Intercepto", "Libros (C)", "Ocupación (C)", "Educación (C)", "Lenguaje (C)", "Libros (M)", "Ocupación (M)", "Educación (M)", "Lenguaje (M)") , custom.header = list("Nivel 1" = 1:3, "Nivel 2" = 4:6), star.symbol = "\\*", center = T, custom.note = " <div style='text-align: justify'> $***p <$ 0.001, $**p <$ 0.01, $*p <$ 0.05 <br> (C) = Centrado a la media del colegio; (M) = Promedio del colegio;  Lenguaje = puntaje simce comprension lectora;  C.Civico = puntaje prueba de conocimiento civico", caption.above = T, caption = "Mediacion multinivel del lenguaje en la desigualdad social del conocimiento civico")
screenreg(list(libros_lenguaje_nse_c,libros_civica_nse_c, libros_civica_nse_leng_c,libros_lenguaje_nse_m, libros_civica_nse_m, libros_civica_nse_leng_m,libros_lenguaje_nse_mc, libros_civica_nse_mc,libros_civica_nse_leng_mc), custom.model.names = c("Lenguaje (C)", "C. Civico (C)","C. Civico (C)", "Lenguaje (M)", "C. Civico (M)", "C. Civico (M)","Lenguaje (ML)", "C. Civico (ML)", "C. Civico (ML)"), custom.coef.names = c("Intercepto", "Libros (C)", "Ocupación (C)", "Educación (C)", "Lenguaje (C)", "Libros (M)", "Ocupación (M)", "Educación (M)", "Lenguaje (M)") , custom.header = list("Nivel 1" = 1:3, "Nivel 2" = 4:6), star.symbol = "\\*", center = T, custom.note = " <div style='text-align: justify'> $***p <$ 0.001, $**p <$ 0.01, $*p <$ 0.05 <br> (C) = Centrado a la media del colegio; (M) = Promedio del colegio;  Lenguaje = puntaje simce comprension lectora;  C.Civico = puntaje prueba de conocimiento civico", caption.above = T, caption = "Mediacion multinivel del lenguaje en la desigualdad social del conocimiento civico")
screenreg(list(libros_lenguaje_nse_mc, libros_civica_nse_mc,libros_civica_nse_leng_mc))
screenreg(list(libros_lenguaje_nse_c,libros_civica_nse_c, libros_civica_nse_leng_c,libros_lenguaje_nse_m, libros_civica_nse_m, libros_civica_nse_leng_m,libros_lenguaje_nse_mc, libros_civica_nse_mc,libros_civica_nse_leng_mc), custom.model.names = c("Lenguaje (C)", "C. Civico (C)","C. Civico (C)", "Lenguaje (M)", "C. Civico (M)", "C. Civico (M)","Lenguaje (ML)", "C. Civico (ML)", "C. Civico (ML)"), custom.coef.names = c("Intercepto", "Libros (C)", "Ocupación (C)", "Educación (C)", "Lenguaje (C)", "Libros (M)", "Ocupación (M)", "Educación (M)", "Lenguaje (M)") , custom.header = list("Nivel 1" = 1:3, "Nivel 2" = 4:6, "Multinivel" =7:9), star.symbol = "\\*", center = T, custom.note = " <div style='text-align: justify'> $***p <$ 0.001, $**p <$ 0.01, $*p <$ 0.05 <br> (C) = Centrado a la media del colegio; (M) = Promedio del colegio;  Lenguaje = puntaje simce comprension lectora;  C.Civico = puntaje prueba de conocimiento civico", caption.above = T, caption = "Mediacion multinivel del lenguaje en la desigualdad social del conocimiento civico")
htmlreg(list(libros_lenguaje_nse_c,libros_civica_nse_c, libros_civica_nse_leng_c,libros_lenguaje_nse_mc, libros_civica_nse_mc,libros_civica_nse_leng_mc), custom.model.names = c("Lenguaje", "C. Civico","C. Civico", "Lenguaje", "C. Civico", "C. Civico"), custom.coef.names = c("Intercepto", "Libros (C)", "Ocupación (C)", "Educación (C)", "Lenguaje (C)", "Libros (M)", "Ocupación (M)", "Educación (M)", "Lenguaje (M)") , custom.header = list("Nivel 1" = 1:3, "Multinivel" =7:9), star.symbol = "\\*", center = T, custom.note = " <div style='text-align: justify'> $***p <$ 0.001, $**p <$ 0.01, $*p <$ 0.05 <br> (C) = Centrado a la media del colegio; (M) = Promedio del colegio;  Lenguaje = puntaje simce comprension lectora;  C.Civico = puntaje prueba de conocimiento civico", caption.above = T, caption = "Mediacion multinivel del lenguaje en la desigualdad social del conocimiento civico")
htmlreg(list(libros_lenguaje_nse_c,libros_civica_nse_c, libros_civica_nse_leng_c,libros_lenguaje_nse_mc, libros_civica_nse_mc,libros_civica_nse_leng_mc), custom.model.names = c("Lenguaje", "C. Civico","C. Civico", "Lenguaje", "C. Civico", "C. Civico"), custom.coef.names = c("Intercepto", "Libros (C)", "Ocupación (C)", "Educación (C)", "Lenguaje (C)", "Libros (M)", "Ocupación (M)", "Educación (M)", "Lenguaje (M)") , custom.header = list("Nivel 1" = 1:3, "Multinivel" =4:6), star.symbol = "\\*", center = T, custom.note = " <div style='text-align: justify'> $***p <$ 0.001, $**p <$ 0.01, $*p <$ 0.05 <br> (C) = Centrado a la media del colegio; (M) = Promedio del colegio;  Lenguaje = puntaje simce comprension lectora;  C.Civico = puntaje prueba de conocimiento civico", caption.above = T, caption = "Mediacion multinivel del lenguaje en la desigualdad social del conocimiento civico")
htmlreg(list(libros_lenguaje_nse_c,libros_civica_nse_c, libros_civica_nse_leng_c,libros_lenguaje_nse_mc, libros_civica_nse_mc,libros_civica_nse_leng_mc), custom.model.names = c("Lenguaje", "C. Civico","C. Civico", "Lenguaje", "C. Civico", "C. Civico"), custom.coef.names = c("Intercepto", "Libros (C)", "Ocupación (C)", "Educación (C)", "Lenguaje (C)", "Libros (M)", "Ocupación (M)", "Educación (M)", "Lenguaje (M)") , custom.header = list("Nivel 1" = 1:3, "Multinivel" =4:6), star.symbol = "\\*", center = T, custom.note = " <div style='text-align: justify'> $***p <$ 0.001, $**p <$ 0.01, $*p <$ 0.05 <br> (C) = Centrado a la media del colegio; (M) = Promedio del colegio;  Lenguaje = puntaje simce comprension lectora;  C.Civico = puntaje prueba de conocimiento civico", caption.above = T, caption = "Mediacion multinivel del lenguaje en la desigualdad social del conocimiento civico")
htmlreg(list(libros_lenguaje_nse_c,libros_civica_nse_c, libros_civica_nse_leng_c,libros_lenguaje_nse_mc, libros_civica_nse_mc,libros_civica_nse_leng_mc), custom.model.names = c("Lenguaje", "C. Civico","C. Civico", "Lenguaje", "C. Civico", "C. Civico"), custom.coef.names = c("Intercepto", "Libros (C)", "Ocupación (C)", "Educación (C)", "Lenguaje (C)", "Libros (M)", "Ocupación (M)", "Educación (M)") , custom.header = list("Nivel 1" = 1:3, "Multinivel" =4:6), star.symbol = "\\*", center = T, custom.note = " <div style='text-align: justify'> $***p <$ 0.001, $**p <$ 0.01, $*p <$ 0.05 <br> (C) = Centrado a la media del colegio; (M) = Promedio del colegio;  Lenguaje = puntaje simce comprension lectora;  C.Civico = puntaje prueba de conocimiento civico", caption.above = T, caption = "Mediacion multinivel del lenguaje en la desigualdad social del conocimiento civico")
results_null = lmer(p.civ ~ 1 + (1 + p.leng | idschool), data = data, REML=F)
results_null = lmer(p.civ ~ 1 + (1 | idschool), data = data, REML=F)
screenreg(results_null)
icc=as.numeric(2917.17 /(2917.17 + 5789.35))
icc
icc
100- icc
1 - icc
df<-data.frame(Variance=c("Entre","Dentro"),
porcentaje=c(icc,1-icc))
ggplot(df,aes(x="",y=porcentaje, fill=Variance))+
geom_bar(stat = "identity",color="white")+
coord_polar(theta="y") +
geom_text(aes(label=paste(porcentaje, "%")),
position=position_stack(vjust=0.5),color="white",size=6)+
coord_polar(theta = "y") + ggtitle("Correlación intraclase de conocimiento cívico")
df<-data.frame(Variance=c("Entre","Dentro"),
porcentaje=c(33.5,66.5))
ggplot(df,aes(x="",y=porcentaje, fill=Variance))+
geom_bar(stat = "identity",color="white")+
coord_polar(theta="y") +
geom_text(aes(label=paste(porcentaje, "%")),
position=position_stack(vjust=0.5),color="white",size=6)+
coord_polar(theta = "y") + ggtitle("Correlación intraclase de conocimiento cívico")
iccplot<-ggplot(df,aes(x="",y=porcentaje, fill=Variance))+
geom_bar(stat = "identity",color="white")+
coord_polar(theta="y") +
geom_text(aes(label=paste(porcentaje, "%")),
position=position_stack(vjust=0.5),color="white",size=6)+
coord_polar(theta = "y") + ggtitle("Correlación intraclase de conocimiento cívico")
iccplot
ggsave(iccplot,filename = "iccplot.png", device = "png" )
screenreg(results_null)
libros_lenguaje_nse_c = lmer(p.leng ~ 1 +  Libros + oc + ed + (1 | idschool), data = data, REML=F)
libros_lenguaje_nse_c = lmer(p.leng ~ 1 +  Libros + Ocupacion + Educacion + (1 | idschool), data = data, REML=F)
libros_civica_nse_c = lmer(p.civ ~ 1 +  Libros + Ocupacion + Educacion  + (1 | idschool), data = data, REML=F)
libros_civica_nse_leng_c = lmer(p.civ ~ 1 + Libros + Ocupacion + Educacion + p.leng  + (1 | idschool), data = data, REML=F)
libros_lenguaje_nse_m = lmer(m_p.leng ~ 1 +  Libros_m + oc_m + ed_m  + (1 | idschool), data = data, REML=F)
libros_civica_nse_m = lmer(m_p.civ ~ 1 +  Libros_m + oc_m + ed_m  + (1 | idschool), data = data, REML=F)
libros_civica_nse_leng_m = lmer(m_p.civ ~ 1 + Libros_m + oc_m + ed_m + m_p.leng  + (1 | idschool), data = data, REML=F)
screenreg(list(libros_lenguaje_nse_c,libros_civica_nse_c,libros_civica_nse_leng_c))
libros_civica_nse_leng_c = lmer(p.civ ~ 1 + Libros + Ocupacion + Educacion + ip_estudiante + p.leng +  + (1 | idschool), data = data, REML=F)
libros_civica_nse_leng_c = lmer(p.civ ~ 1 + Libros + Ocupacion + Educacion + ip_estudiante + p.leng +  + (1 | idschool), data = data, REML=F)
libros_civica_nse_leng_m = lmer(m_p.civ ~ 1 + m_nse + cult_part  + (1 | idschool), data = data, REML=F)
screenreg(list(libros_lenguaje_nse_c, libros_civica_nse_leng_m))
libros_civica_nse_leng_m = lmer(p.civ ~ 1 + m_nse + cult_part  + (1 | idschool), data = data, REML=F)
screenreg(list(libros_lenguaje_nse_c, libros_civica_nse_leng_m))
screenreg(list(results_null,libros_lenguaje_nse_c, libros_civica_nse_leng_m))
(5789.35 - 1842.50)/5789.35
(2917.17 - 728.95)/2917.17
df<-data.frame(Variance=c("N1 Explicada","N2 Explicada","N2 No Explicada", "N1 No Explcada"),
porcentaje=c(44.8,24.75,8.25,20.8))
iccplot<-ggplot(df,aes(x="",y=porcentaje, fill=Variance))+
geom_bar(stat = "identity",color="white")+
coord_polar(theta="y") +
geom_text(aes(label=paste(porcentaje, "%")),
position=position_stack(vjust=0.5),color="white",size=6)+
coord_polar(theta = "y") + ggtitle("Correlación intraclase de conocimiento cívico")
```{r}
df<-data.frame(Variance=c("N1 Explicada","N2 Explicada","N2 No Explicada", "N1 No Explcada"),
porcentaje=c(44.8,24.75,8.25,20.8))
df<-data.frame(Variance=c("N1 Explicada","N2 Explicada","N2 No Explicada", "N1 No Explcada"),
porcentaje=c(44.8,24.75,8.25,20.8))
iccplot<-ggplot(df,aes(x="",y=porcentaje, fill=Variance))+
geom_bar(stat = "identity",color="white")+
coord_polar(theta="y") +
geom_text(aes(label=paste(porcentaje, "%")),
position=position_stack(vjust=0.5),color="white",size=6)+
coord_polar(theta = "y") + ggtitle("Correlación intraclase de conocimiento cívico")
r2plot<-ggplot(df,aes(x="",y=porcentaje, fill=Variance))+
geom_bar(stat = "identity",color="white")+
coord_polar(theta="y") +
geom_text(aes(label=paste(porcentaje, "%")),
position=position_stack(vjust=0.5),color="white",size=6)+
coord_polar(theta = "y") + ggtitle("Correlación intraclase de conocimiento cívico")
df<-data.frame(Variance=c("N1 Explicada","N2 Explicada","N2 No Explicada", "N1 No Explcada"),
porcentaje=c(44,24,8.25,20.8))
r2plot<-ggplot(df,aes(x="",y=porcentaje, fill=Variance))+
geom_bar(stat = "identity",color="white")+
coord_polar(theta="y") +
geom_text(aes(label=paste(porcentaje, "%")),
position=position_stack(vjust=0.5),color="white",size=6)+
coord_polar(theta = "y") + ggtitle("Correlación intraclase de conocimiento cívico")
df<-data.frame(Variance=c("N1 Explicada","N2 Explicada","N2 No Explicada", "N1 No Explcada"),
porcentaje=c(44,24,8.25,20.8))
r2plot<-ggplot(df,aes(x="",y=porcentaje, fill=Variance))+
geom_bar(stat = "identity",color="white")+
coord_polar(theta="y") +
geom_text(aes(label=paste(porcentaje, "%")),
position=position_stack(vjust=0.5),color="white",size=6)+
coord_polar(theta = "y") + ggtitle("Correlación intraclase de conocimiento cívico")
df
df<-data.frame(Variance=c("N1 Explicada","N2 Explicada","N2 No Explicada", "N1 No Explcada"),
porcentaje=c(44,24,8.25,25.75))
r2plot<-ggplot(df,aes(x="",y=porcentaje, fill=Variance))+
geom_bar(stat = "identity",color="white")+
coord_polar(theta="y") +
geom_text(aes(label=paste(porcentaje, "%")),
position=position_stack(vjust=0.5),color="white",size=6)+
coord_polar(theta = "y") + ggtitle("Correlación intraclase de conocimiento cívico")
df<-data.frame(Variance=c("N1 Explicada","N2 Explicada","N2 No Explicada", "N1 No Explcada"),
porcentaje=c(25,25,25,25))
r2plot<-ggplot(df,aes(x="",y=porcentaje, fill=Variance))+
geom_bar(stat = "identity",color="white")+
coord_polar(theta="y") +
geom_text(aes(label=paste(porcentaje, "%")),
position=position_stack(vjust=0.5),color="white",size=6)+
coord_polar(theta = "y") + ggtitle("Correlación intraclase de conocimiento cívico")
